# 数据库索引
> 参考：[AVL树、红黑树、B(B-)树、B+树](https://blog.csdn.net/xlgen157387/article/details/79450295)

> 参考：[为什么数据库索引使用B+树而非红黑树或B-树](https://www.cnblogs.com/aspirant/p/9214485.html)


## AVL树
AVL树是一种强平衡二叉树

产生场景：一般来说，二叉树的平均查找速度会比顺序查询的速度更快，所以二叉树的数据结构适用于查询场景。但是，极端情况下，比如根节点是最小或最大的数，那么二叉树就会退化成线性链路结构，查询速度就和顺序查询差不多。因此，若想构造一个最大性能的二叉查找树，则需设计一颗平衡的二叉树。

AVL树是严格的平衡二叉树（平衡：左右子树树高不超过1）。一般用平衡因子差值判断是否平衡，若不平衡则通过旋转来实现平衡。

![](resources/AVL树.png)

局限性：一旦执行插入/删除操作后导致树变得不平衡，就需要通过旋转来保持平衡。而树的旋转是非常耗时的，导致维护这种高度平衡所付出的代价，比从中获得的效益还要大，实际适用场景有限。

AVL树适合于插入/删除次数不频繁，但查询比较多的情况。Windows NT内核中广泛存在AVL树。


## 红黑树
红黑树是一种弱平衡二叉树。每个节点非红即黑，每条路径都包含相同的黑节点数。通过这种对节点着色方式的限制，红黑树确保没有一条路径会比其它路径长出两倍。

![](resources/红黑树.png)

相对于严格平衡的AVL树，相同节点下，红黑树的高度更大，但是其旋转次数更少。因此，红黑树适用于搜索、插入、删除操作都比较多的情况下。

红黑树应用：Java的TreeMap实现；C++的Map、Set实现；I/O多路复用epoll的实现等。

## B树（B-树）
B树，也就是B-树，是一种平衡多叉树。

1. 每个节点可存储多个关键字key（即索引），即每个key对应的数据指针（即数据的实际存储地址）

2. 非叶子结点的关键字个数 = 指向儿子节点的指针个数 - 1

3. B树不允许各个节点中的关键字重复

4. 关键字key在B树中的排序规则如图所示

![](resources/B树.png)



### `为什么数据库索引使用B类树而非红黑树？`



## B+树
B+树是B树的变形树，也是一种平衡多叉树。

1. B+树的设计思路，是应文件系统的存储结构而生的。文件系统中，文件目录是一级一级的索引，一直到最底层的文件夹中才保存真正的数据。因此，B+树的非叶子节点只保存索引，不保存实际的数据或指针；实际数据或指针都保存在叶子节点中。换句话说，B+树的非叶子节点仅用作索引，而叶子节点中则包含所有关键字key和key对应的数据或指针。

2. B+树的叶子节点中，有一个指针指向下一个叶子节点。这个设计是为了提高区间访问（范围查询）的性能。

3. 非叶子节点的关键字个数 = 指向儿子节点的指针个数 

4. B+树允许各个节点中的关键字重复

5. 关键字key在B+树中的排序规则如图所示

![](resources/B+树.png)




### `数据库索引使用B+树比B树有什么好处？`


